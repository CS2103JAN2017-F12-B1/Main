# A0140036X
###### \java\guitests\guihandles\StatusBarFooterHandle.java
``` java
/**
 * A handle for the StatusBarFooter ui.
 */
public class StatusBarFooterHandle extends GuiHandle {
    private static final String STATUS_BAR_SAVE_LOCATION_ID = "#saveLocationStatus";

    public StatusBarFooterHandle(GuiRobot guiRobot, Stage primaryStage, String stageTitle) {
        super(guiRobot, primaryStage, stageTitle);
    }

    /**
     * Returns location of current save location show in UI.
     * @return location of current task manager file
     */
    public String getSaveLocationText() {
        Scene primaryScene = primaryStage.getScene();
        StatusBar saveLocation = (StatusBar) primaryScene.lookup(STATUS_BAR_SAVE_LOCATION_ID);
        return saveLocation.getText();
    }
}
```
###### \java\guitests\LoadCommandTest.java
``` java
/**
 * LoadCommandTest tests the load command which changes the storage file used
 */

public class LoadCommandTest extends TaskManagerGuiTest {

```
###### \java\guitests\LoadCommandTest.java
``` java
    /**
     * Manages the state of UI for Load command tests.
     *
     * Load command requires changes in data used in UI and jUnit does not guarantee
     * these tests to run after all the other tests so a mechanism must be in place to resume
     * state of app.
     *
     */
    public static class LoadUiState extends UiState {

        private String savedLocation;

        public LoadUiState(LoadCommandTest test) {
            super(test);
        }

```
###### \java\guitests\LoadCommandTest.java
``` java
        /**
         * @see UiState#onSaveState()
         * Records file path location from UI.
         */
        @Override
        public void onSaveState() {
            this.savedLocation = getGuiTest().statusBarHandle.getSaveLocationText();
        }

```
###### \java\guitests\LoadCommandTest.java
``` java
        /**
         * @see UiState#onSaveState()
         * Loads savedLocation
         */
        @Override
        public void onResumeState() {
            ((LoadCommandTest) getGuiTest()).loadFromFilePath(savedLocation);
        }

    }

```
###### \java\guitests\LoadCommandTest.java
``` java
    /**
     * Tests loading of non existent file.
     */
    @Test
    public void load_nonExistentFile() {
        LoadUiState state = new LoadUiState(this);
        state.saveState();
        assertLoad(getNewTestStorageFileName(), new ReadOnlyTask[0]);
        state.resumeState();
    }

```
###### \java\guitests\LoadCommandTest.java
``` java
    /**
     * Tests loading of file.
     * 1. Save current data location
     * 2. Generate tasks
     * 3. Create new storage file
     * 4. Save tasks into storage file
     * 5. Assert load tasks
     * 6. Assert clear tasks
     * 7. Assert add task
     * Resumes with saved location.
     * This test assumes if 5, 6, 7 is successful task manager has been loaded and linked to UI
     * and commands will work on the updated data.
     * @author A0140036X
     */
    @Test
    public void load_createTemporaryTaskManagerAndLoad() {
        LoadUiState state = new LoadUiState(this);
        state.saveState();

        TaskManager tempTaskManager = new TaskManager();
        TestTask[] testTasks = td.getGeneratedTasks(10);
        String testTaskManagerFilePath = getNewTestStorageFileName();

        try {
            tempTaskManager.setTasks(TestUtil.asList(testTasks));
        } catch (DuplicateTaskException e1) {
            assertTrue(false);
        }

        StorageManager storage = new StorageManager(testTaskManagerFilePath, "");
        try {
            storage.saveTaskManager(tempTaskManager);
        } catch (IOException e) {
            assertTrue(false);
        }

        assertLoad(testTaskManagerFilePath, testTasks);
        assertAdd(testTasks);
        assertClear();

        state.resumeState();
    }

```
###### \java\guitests\LoadCommandTest.java
``` java
    /**
     * returns a valid file path for storage file that does not exist.
     */
    private String getNewTestStorageFileName() {
        String testTaskManagerFileName = new Date().getTime() + "_taskmanager.xml";
        return TestUtil.getFilePathInSandboxFolder(testTaskManagerFileName);
    }

```
###### \java\guitests\LoadCommandTest.java
``` java
    /**
     * Tests Load Command.
     * <p>
     * Loads task manager from file path
     * </p>
     * @param testTaskManagerFilePath path of task manager file to load
     * @param tasks tasks to check against those loaded from file
     */
    private void assertLoad(String testTaskManagerFilePath, ReadOnlyTask[] tasks) {
        loadFromFilePath(testTaskManagerFilePath);
        assertTrue(taskListPanel.isListMatching(tasks));
        assertResultMessage(LoadCommand.getSuccessMessage(testTaskManagerFilePath));
    }

```
###### \java\guitests\LoadCommandTest.java
``` java
    /** Tests clear command. */
    private void assertClear() {
        commandBox.runCommand(ClearCommand.COMMAND_WORD);
        assertListSize(0);
        assertResultMessage(ClearCommand.MESSAGE_SUCCESS);
    }

```
###### \java\guitests\LoadCommandTest.java
``` java
    /**
     * Tests add command.
     * @param currentList list to add task to
     * @return new list with added task
     */
    private TestTask[] assertAdd(TestTask[] currentList) {
        TestTask taskToAdd = td.getTypicalTasks()[0];
        TestTask[] expectedList = TestUtil.addTasksToList(currentList, taskToAdd);
        commandBox.runCommand(taskToAdd.getAddCommand());
        assertTrue(taskListPanel.isListMatching(expectedList));
        return expectedList;
    }

```
###### \java\guitests\LoadCommandTest.java
``` java
    /**
     * Enters load command into ui
     */
    private void loadFromFilePath(String filePath) {
        String cmd = "load " + filePath;
        commandBox.runCommand(cmd);
    }
}
```
###### \java\guitests\TaskManagerGuiTest.java
``` java
    /**
     * Simulates a delay.
     * @param milliseconds Time to sleep in milliseconds
     */
    public void sleep(int milliseconds) {
        guiRobot.sleep((milliseconds));
    }
}
```
###### \java\savvytodo\testutil\TypicalTestTasks.java
``` java
    /**
     * generates a list of unique tasks with random details
     * @return list of tasks
     */
    public TestTask[] getGeneratedTasks(int numberOfTasks) {
        TestTask[] ret = new TestTask[numberOfTasks];
        for (int i = 0; i < ret.length; i++) {
            TestTask temp = new TestTask();
            try {
                temp.setName(new Name("Task " + i));
                temp.setDescription(new Description("" + i));
                temp.setLocation(new Location("" + i));
                temp.setPriority(new Priority(i % 2 == 0 ? "low" : "high"));
                temp.setCategories(new UniqueCategoryList());
                temp.setDateTime(new DateTime());
                temp.setRecurrence(new Recurrence());
                temp.setCompleted(new Status(i % 2 == 0 ? true : false));
                temp.setTimeStamp();
            } catch (IllegalValueException e) {
                e.printStackTrace();
            }
            ret[i] = temp;
        }
        return ret;
    }
}
```
###### \java\savvytodo\testutil\UiState.java
``` java
/**
 * UI state manager for gui tests.
 *
 * Some GUI tests are independent from the main flow (eg. LoadCommandTest).
 * This class provides a mechanism for such tests
 * to save relevant state information that is to be resumed at a later time.
 */
public abstract class UiState {
    private TaskManagerGuiTest guiTest;
    private boolean stateSaved = false;

```
###### \java\savvytodo\testutil\UiState.java
``` java
    /**
     * Sets gui test to manage.
     */
    public UiState(TaskManagerGuiTest test) {
        this.setGuiTest(test);
    }

```
###### \java\savvytodo\testutil\UiState.java
``` java
    /**
     * Will be executed when {@link #saveState()} is called.
     */
    public abstract void onSaveState();

```
###### \java\savvytodo\testutil\UiState.java
``` java
    /**
     * Will be executed when {@link #resumeState()} is called.
     */
    public abstract void onResumeState();

```
###### \java\savvytodo\testutil\UiState.java
``` java
    /**
     * Saves state of UI.
     */
    public void saveState() {
        onSaveState();
        stateSaved = true;
    }

```
###### \java\savvytodo\testutil\UiState.java
``` java
    /**
     * Resumes state if previous saved state exists.
     */
    public void resumeState() {
        if (stateSaved) {
            onResumeState();
        }
    }

```
###### \java\savvytodo\testutil\UiState.java
``` java
    /**
     * Returns gui test that state is managed
     */
    public TaskManagerGuiTest getGuiTest() {
        return guiTest;
    }

```
###### \java\savvytodo\testutil\UiState.java
``` java
    /**
     * Sets gui test that state is to be managed
     */
    public void setGuiTest(TaskManagerGuiTest guiTest) {
        this.guiTest = guiTest;
    }
}
```
